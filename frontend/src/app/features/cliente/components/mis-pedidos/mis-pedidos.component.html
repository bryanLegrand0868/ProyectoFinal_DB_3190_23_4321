<div class="mis-pedidos-container">
  <div class="pedidos-header">
    <h1>
      <span class="header-icon">📦</span>
      Mis Pedidos
    </h1>

    <div class="header-actions">
      <select
        [(ngModel)]="selectedStatus"
        (change)="onFilterChange()"
        class="status-filter">
        <option *ngFor="let status of statusOptions" [value]="status.value">
          {{ status.label }}
        </option>
      </select>

      <button type="button"
              class="btn-outlined"
              (click)="continueShopping()">
        🛍️ Seguir comprando
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner">⏳ Cargando pedidos...</div>
  </div>

  <!-- Lista de pedidos -->
  <div class="orders-list" *ngIf="!loading && filteredOrders.length > 0">
    <div class="order-card" *ngFor="let order of filteredOrders"
         (click)="viewOrderDetail(order.id_pedido)">
      <div class="order-header">
        <div class="order-id">
          <span class="label">Pedido #</span>
          <span class="value">{{ order.id_pedido }}</span>
        </div>

        <div class="order-date">
          <span class="date-icon">📅</span>
          {{ order.fecha_pedido | date:'dd/MM/yyyy' }}
        </div>
      </div>

      <div class="order-body">
        <div class="order-info-section">
          <div class="info-item">
            <span class="info-icon">📍</span>
            <div>
              <p class="info-label">Dirección de Envío</p>
              <p class="info-value">{{ order.direccion_envio }}</p>
              <p class="info-value-secondary">{{ order.ciudad_envio }}, {{ order.pais_envio }}</p>
            </div>
          </div>

          <div class="info-item">
            <span class="info-icon">💳</span>
            <div>
              <p class="info-label">Método de Pago</p>
              <p class="info-value">{{ order.tipo_pago.replace('_', ' ') }}</p>
            </div>
          </div>
        </div>

        <div class="order-status-section">
          <div class="status-badge" [ngClass]="getEstadoClass(order.estado_pedido)">
            <span class="status-dot">🔵</span>
            {{ formatEstado(order.estado_pedido) }}
          </div>

          <div class="payment-badge" [ngClass]="getPagoBadgeClass(order.estado_pago)">
            <span class="payment-icon">💰</span>
            Pago: {{ formatEstadoPago(order.estado_pago) }}
          </div>
        </div>

        <div class="order-total-section">
          <p class="total-label">Total</p>
          <p class="total-value">Q{{ order.total | number:'1.2-2' }}</p>
        </div>
      </div>

      <div class="order-footer">
        <div class="delivery-info" *ngIf="order.fecha_entrega_estimada">
          <span class="delivery-icon">🚚</span>
          <span>
            Entrega estimada: {{ order.fecha_entrega_estimada | date:'dd/MM/yyyy' }}
          </span>
        </div>

        <button type="button"
                class="btn-sm btn-outlined"
                (click)="viewOrderDetail(order.id_pedido); $event.stopPropagation()">
          👁️ Ver detalles
        </button>
      </div>
    </div>
  </div>

  <!-- Sin pedidos -->
  <div class="empty-state" *ngIf="!loading && filteredOrders.length === 0">
    <div class="empty-icon">📦</div>
    <h2>No tienes pedidos{{ selectedStatus !== 'TODOS' ? ' en este estado' : '' }}</h2>
    <p>Comienza a comprar ahora y encuentra los mejores productos</p>
    <button type="button"
            class="btn-lg btn-primary"
            (click)="continueShopping()">
      🛍️ Ir a comprar
    </button>
  </div>
</div>
