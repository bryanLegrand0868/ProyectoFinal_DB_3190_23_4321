<h2>Clientes</h2>

<div class="p-fluid">
  <div class="p-field p-grid">
    <div class="p-col-12 p-md-4">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input type="text" pInputText 
               [(ngModel)]="searchQuery" 
               (input)="search()"
               placeholder="Buscar por nombre/email" />
      </span>
    </div>
    <div class="p-col-12 p-md-2">
      <button pButton 
              type="button" 
              label="Buscar" 
              class="p-button-primary"
              (click)="search()"></button>
    </div>
    <div class="p-col-12 p-md-2">
      <button pButton 
              type="button" 
              label="Cargar todos" 
              class="p-button-secondary"
              (click)="loadClientes()"></button>
    </div>
  </div>
</div>

<div *ngIf="loading" class="p-d-flex p-jc-center p-mt-4">
  <p-progressSpinner></p-progressSpinner>
</div>

<p-table [value]="clientes" 
         [loading]="loading"
         [paginator]="true" 
         [rows]="10"
         [showCurrentPageReport]="true"
         currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
         [rowsPerPageOptions]="[10,25,50]">
  <ng-template pTemplate="header">
    <tr>
      <th>ID</th>
      <th>Usuario</th>
      <th>Rol</th>
      <th>Estado</th>
      <th>Fecha Creación</th>
      <th>Último Acceso</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-cliente>
    <tr>
      <td>{{cliente.id_cliente}}</td>
      <td>{{cliente.nombres}}</td>
      <td>{{cliente.rol}}</td>
      <td>
        <span [class]="'customer-badge status-' + (cliente.estado === 'A' ? 'active' : 'inactive')">
          {{cliente.estado === 'A' ? 'Activo' : 'Inactivo'}}
        </span>
      </td>
      <td>{{cliente.FECHA_CREACION | date:'short'}}</td>
      <td>{{cliente.ULTIMO_ACCESO | date:'short' : 'Nunca'}}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage" let-columns>
    <tr>
      <td [attr.colspan]="6" class="p-text-center">
        No se encontraron clientes
      </td>
    </tr>
  </ng-template>
</p-table>

<!-- Add some basic styling -->
<style>
.customer-badge {
  border-radius: 2px;
  padding: .25em .5rem;
  text-transform: uppercase;
  font-weight: 700;
  font-size: 12px;
  letter-spacing: .3px;
}

.customer-badge.status-active {
  background: #C8E6C9;
  color: #256029;
}

.customer-badge.status-inactive {
  background: #FFCDD2;
  color: #C63737;
}
</style>